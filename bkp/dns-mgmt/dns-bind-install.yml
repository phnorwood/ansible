---
- name: install bind dns requirements
  hosts: "{{ target_host }}"
  become: true
  vars_files: vars/dns-config.yml
  tasks:
    - name: install bind
      yum: 
        name: "{{ dns_packages }}"
        state: latest
    - name: configure firewall
      firewalld: 
        service: "{{ item }}"
        state: enabled
        permanent: true
        zone: public
      notify: restart_firewalld
      loop: "{{ dns_firewall_services }}"
    - name: enable named
      service: 
        name: "{{ dns_service }}"
        enabled: true
        state: started
  handlers:
    - name: restart_firewalld
      service:
        name: firewalld
        state: restarted

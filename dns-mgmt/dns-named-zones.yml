---
- name: configure initial DNS files
  hosts: "{{ target_host }}"
  become: true
  vars_files: vars/dns-config.yml
  tasks:
    - name: configure /etc/named.conf
      template: 
        src: vars/named.j2
        dest: /etc/named.conf
        owner: root
        group: named
        mode: 640
        backup: true
    - name: configure forward-zone
      template: 
        src: "vars/{{ dns_forward_zone_file }}"
        dest: "/var/named/{{ dns_forward_zone_file }}"
        owner: root
        group: named
        mode: 640
        backup: true
    - name: configure reverse-zone
      template:
        src: "vars/{{ dns_reverse_zone_file }}"
        dest: "/var/named/{{ dns_reverse_zone_file }}"
        owner: root
        group: named
        mode: 640
        backup: true
    - name: restart named
      service:
        name: named
        state: restarted
